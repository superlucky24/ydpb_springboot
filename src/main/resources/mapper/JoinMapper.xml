<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.ydpb.mapper.JoinMapper">

    <insert id="insertMember" parameterType="kr.go.ydpb.domain.MemberVO">
        INSERT INTO tbl_member (
            memId,  memName, memBirth,    memGender,   memPassword,   memAddress,
            memAddressDetail,   memTel,   memPhone,   memEmail,  memNews,   memRole
        ) VALUES (
            #{memId}, #{memName}, #{memBirth, jdbcType=DATE}, #{memGender}, #{memPassword}, #{memAddress},
            #{memAddressDetail}, #{memTel}, #{memPhone}, #{memEmail}, #{memNews}, 0
        )
    </insert>

<!--    아이디 중복 확인-->
    <select id="countById" parameterType="string" resultType="int">
        SELECT COUNT(*) FROM tbl_member WHERE memId = #{memId}
    </select>

<!--    네이버 카카오 회원 추가-->
<!--   존재하는 회원인지 체크 -->
    <select id="findById" resultType="kr.go.ydpb.domain.MemberVO">
        SELECT *
        FROM tbl_member
        WHERE MEMID = #{memId}
    </select>

<!-- 카카오 가입자 insert-->
    <insert id="insertKaKaoMember" parameterType="kr.go.ydpb.domain.MemberVO">
        INSERT INTO tbl_member (
            MEMID,
            MEMNAME,
            MEMEMAIL,
            LOGINTYPE,
            MEMPASSWORD,
            memRole
        ) VALUES (
             #{memId},
             #{memName},
             #{memEmail},
             'KAKAO',
             #{memPassword},
             0
         )
    </insert>

<!-- 네이버 가입자 insert-->
    <insert id="insertNaverMember" parameterType="kr.go.ydpb.domain.MemberVO">
        INSERT INTO tbl_member (
            MEMID,
            MEMNAME,
            MEMEMAIL,
            LOGINTYPE,
            MEMPASSWORD,
            MEMPHONE,
            memRole
        ) VALUES (
             #{memId},
             #{memName},
             #{memEmail},
             'NAVER',
             #{memPassword},
             #{memPhone},
             0
         )
    </insert>

    <!--    두 사이트 가입자 한번에 처리하는 동적 sql-->
    <insert id="insertNaverKakaoMember" parameterType="kr.go.ydpb.domain.MemberVO">
        INSERT INTO TBL_MEMBER
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="memId != null">memId,</if>
            <if test="memName != null">memName,</if>
            <if test="memEmail != null">memEmail,</if>
            <if test="loginType != null">loginType,</if>
            <if test="memPassword != null">memPassword,</if>
            <if test="memPhone != null">memPhone,</if>
            memRole
        </trim>
        <trim prefix="VALUES (" suffix=")" suffixOverrides=",">
            <if test="memId != null">#{memId},</if>
            <if test="memName != null">#{memName},</if>
            <if test="memEmail != null">#{memEmail},</if>
            <if test="loginType != null">#{loginType},</if>
            <if test="memPassword != null">#{memPassword},</if>
            <if test="memPhone != null">#{memPhone},</if>
            0
        </trim>
    </insert>


</mapper>