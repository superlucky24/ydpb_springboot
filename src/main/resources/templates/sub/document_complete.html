<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가족관계증명서 발급 완료 | 영등포본동 주민센터</title>
    <link rel="stylesheet" th:href="@{/css/reset.css}">
    <link rel="stylesheet" th:href="@{/css/ydpb.css}">
    <link rel="stylesheet" th:href="@{/css/ydpb_status.css}">
    <link rel="stylesheet" th:href="@{/css/ydpb_SHAdd.css}">
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script th:src="@{/js/ydpb.js}"></script>
</head>
<body>
<div id="wrap">
    <header class="header" th:replace="~{/common/header_footer_layout :: header}"></header>
    <div class="search" th:replace="~{/common/header_footer_layout :: search}"></div>

    <div class="container">
        <div class="contents_wrap safe_area">
            <aside class="side_menu" th:replace="~{/common/sidemenu_layout :: sidemenu}"></aside>

            <main>
                <div class="location">
                    <div class="location_title"><h2>서류 발급 신청 결과</h2></div>
                    <div class="location_path">
                        <span class="loc_home"><a th:href="@{/}">홈</a></span>
                        <span class="loc_arrow">></span>
                        <span class="loc_text">민원안내</span>
                        <span class="loc_arrow">></span>
                        <span class="loc_text">가족관계증명서</span>
                    </div>
                </div>

                <div class="contents">
                    <h3 class="title">증명서 발급 정보</h3>

                    <div class="temp_box type1">
                        <div class="temp_box_wrap">
                            <table class="table_form">
                                <colgroup>
                                    <col style="width:25%;">
                                    <col style="width:75%;">
                                </colgroup>
                                <tbody>
                                <tr>
                                    <th>신청인 성명</th>
                                    <td th:text="${doc.userName}">-</td>
                                </tr>
                                <tr>
                                    <th>발급 서류</th>
                                    <td>가족관계증명서 (일반)</td>
                                </tr>
                                <tr>
                                    <th>결제 상태</th>
                                    <td><span style="color:#356bbe; font-weight:600;">수수료 결제 완료</span></td>
                                </tr>
                                <tr>
                                    <th>처리 결과</th>
                                    <td><span style="color:#e9463c; font-weight:600;">즉시 발급 가능</span></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div style="margin-top:20px;">
                        <ul class="ul_common">
                            <li>아래 [증명서 확인 및 출력] 버튼을 클릭하면 인쇄 가능한 증명서 창이 열립니다.</li>
                            <li>브라우저의 인쇄 기능을 통해 PDF로 저장하거나 프린터로 출력하실 수 있습니다.</li>
                            <li>개인정보 보호를 위해 출력 후에는 반드시 창을 닫아주시기 바랍니다.</li>
                        </ul>
                    </div>

                    <div class="form_btns_wrap" style="justify-content: center; margin-top:50px; gap:15px;">
                        <button type="button" onclick="openPrintWindow()" class="btn btn_write"
                                style="width:240px; height:50px; line-height:34px; font-size:1.8rem; cursor:pointer;">
                            증명서 확인 및 출력
                        </button>
                        <a th:href="@{/}" class="btn btn_cancel"
                           style="width:140px; height:50px; line-height:34px; font-size:1.8rem;">
                            홈으로 이동
                        </a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <footer class="footer" th:replace="~{/common/header_footer_layout :: footer}"></footer>
</div>

<script th:inline="javascript">
    /* 증명서 출력용 팝업창 엶 */
    function openPrintWindow() {
        // 데이터는 세션에 있으므로 추가 파라미터 없이 인쇄 경로만 호출
        const printUrl = "/document/print";

        const popupWidth = 900;
        const popupHeight = 1000;
        // 화면 정중앙에 띄우도록 설정
        const left = (window.screen.width / 2) - (popupWidth / 2);
        const top = (window.screen.height / 2) - (popupHeight / 2);

        const newWindow = window.open( // 팝업창 띄움
            // 창 주소
            printUrl,
            // 창 이름
            "FamilyCertificatePrint",
            // 창 설정
            `width=${popupWidth}, height=${popupHeight}, left=${left}, top=${top}, scrollbars=yes, toolbars=no, status=no`
        );

        // 브라우저 팝업 차단 설정 되어있을때 대비
        if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {
            alert("브라우저의 팝업 차단 설정으로 인해 창이 열리지 않았습니다. 팝업 허용 후 다시 시도해 주세요.");
        }
    }
</script>
</body>
</html>